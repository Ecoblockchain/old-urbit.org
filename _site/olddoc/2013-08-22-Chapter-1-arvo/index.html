<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Chapter 1 &#58; Crash course in Arvo &middot; Urbit
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">

  <!-- Icons -->

   <link rel="shortcut icon" href="/favicon.png">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body>

    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <img src="/public/urbit_logo_ur.svg">
      <br>
      <h1>Urbit</h1>
      <p class="lead">a personal cloud computer</p>
    </div>

    <ul class="sidebar-nav">
      <li class="sidebar-nav-item">
        <a href="/">What is Urbit?</a>
      </li>

      

      
      
        
          
        
      
        
          
            <li class="sidebar-nav-item">
              <a href="/about/">About</a>
            </li>
          
        
      
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
<<<<<<< HEAD
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
=======
>>>>>>> fbe1946cebf8a6abfa8ee8fce81a18646724a412
            <li class="sidebar-nav-item">
              <a href="/blog/">Blog</a>
            </li>
          
        
      
        
          
            <li class="sidebar-nav-item">
              <a href="/dev/">Developer</a>
            </li>
          
        
      
        
          
            <li class="sidebar-nav-item">
              <a href="/doc/">Documentation</a>
            </li>
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
            <li class="sidebar-nav-item">
              <a href="/setup/">Setup</a>
            </li>
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      

      <li class="sidebar-nav-item"><a href="https://github.com/urbit/urbit">GitHub</a></li>
      <li class="sidebar-nav-item"><a href="https://groups.google.com/forum/#!forum/urbit-dev">Mailing List</a></li>
      <li class="sidebar-nav-item">Cooling at <a href="/blog/2014/02/16/mars/">544 Kelvin</a></li>
      <li>Last Continuity Breach: <a href="/blog/2014/01/06/continuity/">~2014.1.6</a></li>
    </ul>
    <p>urbit@urbit.org</p>
  </div>
</div>


    <div class="content container">
      <div class="post">
  <h1 class="post-title">Chapter 1 &#58; Crash course in Arvo</h1>
  <p>Welcome to Urbit!</p>

<h1>1.0  YO THIS IS UNFINISHED SHIT!</h1>

<p>All of the doc herein is cheerfully certified as incorrect,
incomplete, misleading and almost certainly misguided.  Do not
use!  Please return to your NSA-certified digital plantation.
If you found this site by accident, please keep it to yourself.
Clear your hard drive, wipe your search history... but always
trust content from Tlon, Tianming, Urban Republic.</p>

<h1>1.1 Build</h1>

<p>First, build...</p>

<h3>Prepare your computer:</h3>

<p>Urbit depends on:</p>

<ul>
<li>gmp</li>
<li>libsigsegv</li>
<li>openssl</li>
<li>libssl-dev (Linux only)</li>
<li>ncurses (Linux only)</li>
</ul>

<p>Currently we support OSX, Ubuntu, Debian and AWS Linux AMI. Intrepid
ninjas may attempt ports to other OSes. If you&#39;re not an intrepid
ninja, try a VM (eg, VirtualBox).</p>

<p><strong>OS X:</strong></p>

<ol>
<li><p>Do you have XCode?  Type <code>gcc</code>.  If it says <code>no input files</code>, you have XCode.</p>

<p>Otherwise, install XCode: <code>https://developer.apple.com/xcode/</code>, with the 
Command Line tools.</p></li>
<li><p>Install dependencies</p>

<ul>
<li><p>Do you have Homebrew?  Type <code>brew</code>.  If it does something, you have Homebrew. </p>

<p>Otherwise, <code>ruby -e &quot;$(curl -fsSL https://raw.github.com/mxcl/homebrew/go)&quot;</code> 
will install it.</p>

<p>And follow up with <code>sudo brew install gmp libsigsegv openssl</code></p>

<p>This will ask you for the root password, which ideally you know.</p></li>
</ul></li>
</ol>

<ul>
<li><p>Macports? Type <code>port</code>.  If it does something, you have Macports.</p>

<p>Otherwise go <a href="http://www.macports.org/install.php" title="here">here</a>.</p>

<p>Then <code>sudo port install gmp libsigsegv openssl</code></p>

<p>Enter your root password at the prompt.</p></li>
</ul>

<p><strong>Ubuntu or Debian:</strong></p>

<ol>
<li><code>sudo apt-get install libgmp3-dev libsigsegv-dev openssl libssl-dev libncurses5-dev git make exuberant-ctags</code></li>
</ol>

<p><strong>AWS:</strong></p>

<ol>
<li><code>sudo yum --enablerepo epel install gcc git gmp-devel openssl-devel ncurses-devel libsigsegv-devel ctags</code></li>
</ol>

<h3>Get the source:</h3>

<p>Either:</p>

<p>A. Download and unzip <code>https://github.com/urbit/urbit/archive/master.zip</code>.</p>

<p>B. <code>git clone https://github.com/urbit/urbit.git</code>. </p>

<h3>Configure your build:</h3>

<p><code>cd</code> to the unpacked Urbit directory you just created.  If this works,
<code>ls urb</code> should show:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">urbit.pill  zod/
</code></pre></div>
<p>Great!  Now, let&#39;s do some dirty Unix stuff to set up your environment.
If you know what this is doing, feel free to do it right.  Otherwise:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">echo &quot;export URBIT_HOME=`pwd`/urb&quot; &gt;&gt;~/.bash_profile
source ~/.bash_profile
</code></pre></div>
<p>To make sure this worked, </p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">echo $URBIT_HOME
</code></pre></div>
<p>should show <code>/urb</code> within the current directory.</p>

<h3>make:</h3>

<p><code>make</code>.  Sometimes things are just easy.</p>

<h3>vere:</h3>

<p>Run <code>bin/vere -c mypier</code>, where <code>mypier</code> is a directory that doesn&#39;t yet exist.
All your state (an append-only log and a memory checkpoint) will live in this
directory.  Its name doesn&#39;t matter and is not visible internally.</p>

<p>A <em>pier</em> is an Urbit virtual machine that hosts one or more Urbit identities,
or <em>ships</em>.  When you run <code>vere -c</code>, it automatically creates a 128-bit ship,
or <code>submarine</code>.  Your name (a hash of a randomly-generated public key) will
look like:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~machec-binnev-dordeb-sogduc--dosmul-sarrum-faplec-nidted
</code></pre></div>
<p>First you&#39;ll see a string of messages like:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">vere: urbit home is /Users/cyarvin/Documents/src/u3/urb
loom: mapped 1024MB
time: ~2013.9.1..03.57.11..4935
ames: on localhost, UDP 63908.
generating 2048-bit RSA pair...
</code></pre></div>
<p>and then it&#39;ll pause a little, &#39;cause this is slow... and then</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">saving passcode in /Users/cyarvin/.urbit/~magsut-hopful.txt
(for real security, write it down and delete the file...)
</code></pre></div>
<p>and, then, if the network gods are happy, your submarine will start pulling
down Arvo files:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text"> + /~machec-binnev-dordeb-sogduc--dosmul-sarrum-faplec-nidted/main/1/bin/ticket/hoon
 + /~machec-binnev-dordeb-sogduc--dosmul-sarrum-faplec-nidted/main/1/bin/reset/hoon
 + /~machec-binnev-dordeb-sogduc--dosmul-sarrum-faplec-nidted/main/1/bin/ye/hoon
 + /~machec-binnev-dordeb-sogduc--dosmul-sarrum-faplec-nidted/main/1/bin/ls/hoon
</code></pre></div>
<p>and the like.  You&#39;ll see a couple pages of this stuff.  Don&#39;t worry too much
about the details right now.  Finally, you&#39;ll get the Arvo shell prompt (which
is also a Hoon REPL):</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~machec-binnev-dordeb-sogduc--dosmul-sarrum-faplec-nidted/try=&gt; 
</code></pre></div>
<p>Next, you need to decide whether a mere submarine is enough for you right now.
This monicker is a mouthful.  You can stick with it (for now), but... you&#39;re
going to need a wider xterm.</p>

<p>Which might be fine!  However, please note that just by sending a simple email,
you can get a much better ship - a <code>destroyer</code>, with a nice short name like</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc
</code></pre></div>
<p>Just email <code>urbit@urbit.org</code>, with your submarine in the subject.  We&#39;ll send you
destroyers - not one, but <em>two</em>.  Yes, two!  Tell us something cool in the
body, and we&#39;ll send you even more.</p>

<p>If you have a destroyer, you need to configure it.  Otherwise, just stretch
that xterm wide and skip to section 1.2.</p>

<p>Your destroyers will arrive in the form of [ship ticket] pairs.  Let&#39;s say one
of your ships is <code>~waclux-tomwyc</code> and its ticket is </p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~ribdyr-famtem-larrun-figtyd
</code></pre></div>
<p>(What are these strings, anyway?  Just random unsigned integers, rendered in
Hoon&#39;s syllabic base, <code>@p</code>.)</p>

<p>A new life awaits you on the off-world colonies!  To begin, just type at the
prompt:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">:begin ~waclux-tomwyc
</code></pre></div>
<p>and follow the directions.  When the script completes, hit return and you&#39;ll be
the <code>~waclux-tomwyc</code> you wanted to be.</p>

<h1>1.2 Taming Arvo</h1>

<p>If all went well, you now have a nice short prompt:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/try=&gt;
</code></pre></div>
<p>If all did not go well (send us another email), or you&#39;re just too impatient to
wait for your destroyer, you have a big long prompt.  Which is fine, really,
just ugly - and all these exercises will still work.</p>

<p>Let&#39;s try a few quick things to stretch your fingers.  Type these command lines
and you should see the matching results:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/try=&gt; &quot;hello, world&quot;
&quot;hello, world&quot;

~waclux-tomwyc/try=&gt; (add 2 2)
4

~waclux-tomwyc/try=&gt; :hello %world
&quot;hello, world.&quot;

~waclux-tomwyc/try=&gt; :cat /=main=/bin/hello/hoon
::
::  /=main=/bin/hello/hoon
::
|=  *
|=  [planet=@ta ~]
^-  bowl
:_  ~  :_  ~
:-  %%
!&gt;(&quot;hello, {(trip planet)}.&quot;)
</code></pre></div>
<p>What did you just do?  </p>

<p>One, you used Arvo as a Hoon REPL to print the constant <code>&quot;hello, world&quot;</code>, which
is a fancy way to write the Nock noun </p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">[104 101 108 108 111 44 32 119 111 114 108 100 0]
</code></pre></div>
<p>Two, you called the Hoon <code>add</code> function to see that two plus two is four.  Math
seems to work the same on the off-world colonies.</p>

<p>Three, you ran the Arvo application <code>:hello</code> with the argument
<code>%world</code>, which is just a fancy way to write the atom
<code>431.316.168.567</code> (or, for non-Germans, <code>431,316,168,567</code>).  You
might recognize it better as <code>0x64.6c72.6f77</code> - the ASCII
characters in LSB first order.</p>

<p>(Is Urbit German?  Sadly, no.  But all our noun print formats are
URL-safe, which dot is and comma isn&#39;t.)</p>

<p>And you (4) used the Arvo application :cat to print the Hoon file</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">/=main=/bin/hello/hoon
</code></pre></div>
<p>which, supposing your current date is</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~2013.9.1..04.38.31..f259
</code></pre></div>
<p>(ie, September 1, 2013 at 4:38:31 GMT/LS25 plus 0xf259/65536
seconds), is equivalent to the global path</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">/~waclux-tomwyc/main/~2013.8.23..04.38.31..f259/bin/hello/hoon
</code></pre></div>
<p>which anyone in Urbit can, see and even use - but we&#39;re getting ahead of
ourselves.</p>

<p>In any case, what we&#39;ve seen is that Arvo is a dangerous and powerful operating
system which if handled improperly can cause serious injury or loss of life.
We exaggerate.  Slightly.</p>

<p>The first thing you need to know is how to control this tool.  Try your arrow
keys - you&#39;ll see that Arvo has traditional Unix history editing.  Up and down,
left and right work, as do the simple emacs controls:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">^A  go to beginning of line
^B  left arrow
^D  delete next character
^E  go to end of line
^F  right arrow
^K  kill to end of line
^L  clear the screen
^U  kill the whole line
^Y  yank (restore from kill ring)
</code></pre></div>
<p>Don&#39;t expect any other emacs (or even readline - this is not readline, it&#39;s
internal to Arvo) commands to work.</p>

<p>There are also some special control keys specific to Arvo.  It&#39;s a good idea to
learn these first so that you feel in, um, control.</p>

<p>First, we&#39;ll quit out of an infinite loop with ^C:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/try=&gt; :infinite
</code></pre></div>
<p>When you hit return at the end of this line, Arvo will appear to hang.  Do not
be alarmed!  This is not a bug - it means that we&#39;ve started running our
infinite loop before printing the next console prompt.  Simply hit ^C, and
you&#39;ll see </p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">! intr
~waclux-tomwyc/try=&gt; :infinite
</code></pre></div>
<p>Hit ^U to delete the line and escape from infinity.  Arvo is a deterministic
OS; you interrupted it while processing an event that would never terminate.
It returns to the state it was in before you hit return - as if nothing had
ever happened.</p>

<p>You&#39;re probably used to using nondeterministic, preemptive OSes, in which the
difference between a waiting process and an executing event isn&#39;t apparent to
the user.  Since Arvo is not preemptive, it has two very different states:
waiting and working.</p>

<p>When Arvo is working, ^C cancels the event it&#39;s working on.  When Arvo is
waiting, ^C ends the current task, which is the task that&#39;s currently prompting
you - or showing the <code>[waiting...]</code> prompt, indicating that it&#39;s waiting for
something else other than keyboard input.</p>

<p>Try this by running</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/try=&gt; :begin

Do you have a ship and a ticket? yes
</code></pre></div>
<p>Then hit ^C and you&#39;ll be back to the command prompt (which, unlike in Unix, is
not a task itself, but part of the OS).</p>

<p>We don&#39;t always want to kill the prompting task.  We often want to switch
between tasks, or between tasks and the command line.  Sort of like switching
between windows, except in a command line.  We do this with ^X.  Try</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/try=&gt; :begin

Do you have a ship and a ticket? yes
</code></pre></div>
<p>But hit ^X instead of ^C.  You&#39;ll get a prompt again.  Use it:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/try=&gt; :begin

~waclux-tomwyc/try=&gt; :hello %world
&quot;hello, world.&quot;
~waclux-tomwyc/try=&gt; 
</code></pre></div>
<p>Hit ^X again:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/try=&gt; :begin

~waclux-tomwyc/try=&gt; :hello %world
&quot;hello, world.&quot;
Do you have a ship and a ticket? yes
</code></pre></div>
<p>And finally, hit ^C to kill the task.</p>

<p>There&#39;s one more magic control key that switches your whole
reality.  This is ^W, which switches between the ships in a pier.
Do you have multiple ships in your pier?  Sure - you still have
your old submarine.  Hit ^W:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~machec-binnev-dordeb-sogduc--dosmul-sarrum-faplec-nidted/try=&gt; 
</code></pre></div>
<p>Hit ^W again:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/try=&gt;
</code></pre></div>
<p>Finally, Arvo is a single-level store.  Since it&#39;s not the &#39;70s
anymore and disk is cheap, everything you do is saved for ever.
(In fact, it&#39;s saved in two ways - as a memory image and an 
event log - so you, or the government if they haz your filez, 
can repeat every computation you&#39;ve every performed.)</p>

<p>As in Unix, hitting ^D on an empty line ends the program:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/try=&gt; 
oxford:~/urbit; pwd
/Users/cyarvin/urbit
oxford:~/urbit; echo &quot;hello, world&quot;
hello, world
oxford:~/urbit; 
</code></pre></div>
<p>Then you can restart and be right back where you were - just
run <code>vere</code> without <code>-c</code>:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">oxford:~/urbit; bin/vere mypier
vere: urbit home is /Users/cyarvin/urb
loom: loaded 9MB
time: ~2013.9.1..17.23.05..0cc1
ames: on localhost, UDP 60342.
http: live on 8080
rest: checkpoint to event 383
rest: old 0v1c.gkr1o, new 0v10.m4gdu
---------------- playback complete----------------
waclux-tomwyc/try=&gt; 
</code></pre></div>
<p>Use your arrow keys and you&#39;ll see your history is still there.
Arvo is indestructible and can be shut down however you like
without losing data.  Also, starting a new process while an old
one is still running will kill the old one safely.  And, to leave
a server running in the background, use <code>vere -d</code>.</p>

<p>But don&#39;t try to operate the same ship on two Unix hosts at the
same time.  This will confuse everyone, including yourself.</p>

<h1>1.3 Path magic</h1>

<p>What do we know?  Okay, so this is an OS.  It&#39;s a little like
Unix but different.  It can print expressions and run commands.
Commands start with a colon.  Let&#39;s try the simplest command:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/try=&gt; :ls
! type-fail
! exit
</code></pre></div>
<p>Hey, that didn&#39;t work!  It didn&#39;t work for two reasons.  One,
Arvo command-line arguments are typed, and <code>:ls</code> expects a path.
Two, <code>:ls</code> needs that path - unlike in Unix, applications can&#39;t
see the current path or shell variables.  (This is because Arvo
doesn&#39;t have 57 different ways of configuring an app.)  So try</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/try=&gt; :ls /~waclux-tomwyc/try=
con bin lib doc
</code></pre></div>
<p>This seems somewhat cumbersome - isn&#39;t there a way to refer to
the current path?  There is, though it doesn&#39;t look like Unix.</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/try=&gt; :ls %
con bin lib doc
</code></pre></div>
<p>Let&#39;s look at these paths in a little more detail.  An Arvo path
is more or less the same thing as a Unix path, except that Unix
isn&#39;t a global revision-control store.  It has the general form</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">/ship/desk/case/spur
</code></pre></div>
<p>where <code>ship</code> is your ship, <code>desk</code> is a project (repository,
branch, etc), <code>case</code> is a revision of that project (a change
number, a date or a label), and <code>spur</code> is a path within it.</p>

<p>As in Unix, the shell (<code>batz</code>) keeps a current path.  As in 
Unix, you can write paths in an absolute or relative syntax,
and as in Unix <code>/</code> is the path separator.  Everything else
is completely different.</p>

<p>Let&#39;s use the REPL to print out some paths.  First, here&#39;s
the current path or something like it:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/try=&gt; /~waclux-tomwyc/try/~2013.9.1
[&#39;~waclux-tomwyc&#39; %try &#39;~2013.9.1&#39; ~]
</code></pre></div>
<p>For complicated reasons related to the Hoon type system - which, 
for a higher-order functional type inference engine, is as stupid
as we could make it - this noun gets rendered as a tuple rather
than a path.  We can rectify this with a cast:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/try=&gt; `path`/~waclux-tomwyc/try/~2013.9.1
/~waclux-tomwyc/try/~2013.9.1
</code></pre></div>
<p>It&#39;s the same value, just printed differently.  Except for the
date, this is the same as your current path:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/try=&gt; `path`%
/~waclux-tomwyc/try/~2013.9.1..17.49.18..282e
</code></pre></div>
<p>The current date, of course, is always changing:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/try=&gt; `path`%
/~waclux-tomwyc/try/~2013.9.1..17.50.39..7e38
</code></pre></div>
<p>Just to remind ourselves that these are Hoon expressions:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/try=&gt; `path`/(scot %p -&gt;-)/try/(scot %da (add ~d7 -&lt;-))
/~waclux-tomwyc/try/~2013.9.8..17.55.03..b2ae
</code></pre></div>
<p>That&#39;s you next week.  It&#39;s black magic, don&#39;t worry about it.
Let&#39;s get back to relative paths.</p>

<p>A relative path is a function of the current path.  First, let&#39;s
make the current path interesting by moving to something deeper:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/try=&gt; :cd /=main=/foo/bar/baz/bam
~waclux-tomwyc/main=/foo/bar/baz/bam&gt; 
</code></pre></div>
<p>Hey, wait, we actually used a relative path here.  The simplest
kind of relative path matches the current path by replacing a
path component with <code>=</code>.  So we could just as well have said</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/main=/foo/bar/baz/bam&gt; -&lt;+
&#39;~2013.9.1..21.38.34..7a08&#39;
~waclux-tomwyc/main=/foo/bar/baz/bam&gt; :cd /~waclux-tomwyc/main/[-&lt;+]/foo/bar/baz/bam
</code></pre></div>
<p>Why is <code>-&lt;+</code> the current date as text?  Look, we&#39;re trying to
learn Arvo without too much Hoon here.  Just accept that it is.
In this context, anyway.  Notice also that the prompt uses a
relative path when (as is usually the case) the current case 
is just the present time, so that we don&#39;t have to stare at</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/main/~2013.9.1..21.38.34..7a08/foo/bar/baz/bam&gt;
</code></pre></div>
<p>In any case, we can now use <code>=</code> to our heart&#39;s content.  Notice
that you don&#39;t need <code>/</code> to separate content from <code>=</code>.  <code>==</code> is
perfectly fine, too.</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/main=/foo/bar/baz/bam&gt; `path`/=
/~waclux-tomwyc
~waclux-tomwyc/main=/foo/bar/baz/bam&gt; `path`/==
/~waclux-tomwyc/main
~waclux-tomwyc/main=/foo/bar/baz/bam&gt; `path`/===
/~waclux-tomwyc/main/~2013.9.1..21.46.46..b250
~waclux-tomwyc/main=/foo/bar/baz/bam&gt; `path`/===zebra==
/~waclux-tomwyc/main/~2013.9.1..21.47.45..9ec8/zebra/bar/baz
</code></pre></div>
<p>I guess you could do this on Unix.  With awk or something.  It&#39;s
apparently been some time since the Nixon administration - how
about a new OS?  Anyway, there&#39;s another way to edit paths - with
<code>%</code>, which we&#39;ve seen before, from the end -</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/main=/foo/bar/baz/bam&gt; `path`%
/~waclux-tomwyc/main/~2013.9.1..21.53.17..07f6/foo/bar/baz/bam
~waclux-tomwyc/main=/foo/bar/baz/bam&gt; `path`%/frampton/comes/alive
/~waclux-tomwyc/main/~2013.9.1..21.55.53..8c5f/foo/bar/baz/bam/frampton/comes/alive
</code></pre></div>
<p>Unix can back up with <code>..</code>.  We do the same with multiple <code>%</code>:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/main=/foo/bar/baz/bam&gt; `path`%%
/~waclux-tomwyc/main/~2013.9.1..22.22.51..34a1/foo/bar/baz
~waclux-tomwyc/main=/foo/bar/baz/bam&gt; `path`%%%
/~waclux-tomwyc/main/~2013.9.1..22.22.53..a332/foo/bar
~waclux-tomwyc/main=/foo/bar/baz/bam&gt; `path`%%%%
/~waclux-tomwyc/main/~2013.9.1..22.22.55..4909/foo
~waclux-tomwyc/main=/foo/bar/baz/bam&gt; `path`%%%%/frampton/comes/alive
/~waclux-tomwyc/main/~2013.9.1..22.23.02..9b05/foo/frampton/comes/alive
</code></pre></div>
<p>Finally, we can use <code>%</code> as a separator and edit both prefix and
suffix.  In this case, <code>=</code> is assumed up to the endpoint edit:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/main=/foo/bar/baz/bam&gt; `path`/=zebra%%%%/frampton/comes/alive
/~waclux-tomwyc/zebra/~2013.9.1..22.26.39..e76d/foo/frampton/comes/alive
</code></pre></div>
<p>Thus concludes our edition of Path School.  Let&#39;s go back to the
default desk (<code>try</code>, meant for experiments only):</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/main=/foo/bar/baz/bam&gt; :cd /=try=
~waclux-tomwyc/try=&gt; 
</code></pre></div>
<h1>1.4 Actual editing</h1>

<p>But wait!  There seem to be a bunch of files in your ship.  How
did they get there?  Oh, right, installation automatically
checked them out of <code>~zod</code> or <code>~doznec</code>.  That&#39;s one way to get
files.  We&#39;ll see more of this in a little bit.</p>

<p>Another way is to cook your files up within Arvo itself.  We&#39;ll
see this in the next chapter, but it&#39;s worth noting its
limitations - no one has ported <code>vim</code> to Arvo yet, nor will for a
long time.</p>

<p>The easiest way to get data in and out of Arvo is just to sync.
You&#39;ll find a complete copy of your ship&#39;s filesystem, as of the
current date, in your <code>$URBIT_HOME</code>.  For example:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/try=&gt; :cat %/bin/goodbye/hoon
|=  *
|=  [planet=tape ~]
:_  ~  :_  ~
[%$ !&gt;(&quot;hello, {planet}.&quot;)]
~waclux-tomwyc/try=&gt;
</code></pre></div>
<p>Then either stop the server with ^D, or switch to another window:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">oxford:~/urbit; cat $URBIT_HOME/waclux-tomwyc/try/bin/goodbye.hoon
|=  *
|=  [planet=tape ~]
:_  ~  :_  ~
[%$ !&gt;(&quot;hello, {planet}.&quot;)]
oxford:~/urbit; 
</code></pre></div>
<p>As you see, the dot-extension pattern in Unix gets converted to a
path slash in Arvo.  Otherwise, the mapping is straightforward.
Legal Arvo paths are a strict subset of Unix paths - for
example, uppercase characters are not allowed - so the round trip
is always clean.  So long as Urbit is always the primary state
and Unix is only a derived view, this works great.</p>

<p>Edit <code>$URBIT_HOME/waclux-tomwyc/try/bin/goodbye.hoon</code>, in another window or
while the server is down, then restart the server.  As soon as you enter any
keyboard input in <code>vere</code>, you&#39;ll see </p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">: /~waclux-tomwyc/try/2/bin/goodbye/hoon
~waclux-tomwyc/try=&gt;  
</code></pre></div>
<p>Go ahead and type </p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/try=&gt; :goodbye &quot;world&quot;
&quot;goodbye, world.&quot;
~waclux-tomwyc/try=&gt; 
</code></pre></div>
<p>What happened here?  Arvo, of course, cannot make system calls
and does not have any access at all to the Unix filesystem.  But
Arvo processes an event stream which the Unix program <code>vere</code>
follows, and generates actions which <code>vere</code> applies.  If you know
Git, the best way to see <code>$URBIT_HOME</code> is as a working directory
in which changes are automatically committed.</p>

<h1>1.5 Local revision control</h1>

<p>Now you&#39;re ready to see the full power of this fully armed
and operational revision-controlled filesystem.  </p>

<p>Of course, you can build a revision-control system on top of
Unix.  And many have.  That doesn&#39;t make Unix a revision-control
system, though.  VMS had something of the sort.  (Some of us are
so old we actually used VMS.)  But VMS had... other issues...</p>

<p>Again, an Arvo path starts with <code>/ship/desk/case</code>.  The case,
ie version, applies to the whole desk, ie, project.  When we
edited <code>/=try=/bin/goodbye/hoon/</code>, our change created case
<code>2</code> of <code>/~waclux-tomwyc/try</code>.</p>

<p>All paths are immutable and referentially transparent.  Once
we&#39;ve made our change, both cases of <code>/~waclux-tomwyc/try</code> exist
(logically; they&#39;re not actually copied, of course):</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/try=&gt; :cat /=try/1/bin/goodbye/hoon
|=  *
|=  [planet=tape ~]
:_  ~  :_  ~
[%$ !&gt;(&quot;hello, {planet}.&quot;)]

~waclux-tomwyc/try=&gt; :cat /=try/2/bin/goodbye/hoon
|=  *
|=  [planet=tape ~]
:_  ~  :_  ~
[%$ !&gt;(&quot;goodbye, {planet}.&quot;)]
</code></pre></div>
<p>Time also works as you&#39;d expect.  Remember, <code>=</code> as the case means
&quot;at the current time&quot;:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/try=&gt; :cat /=try=/bin/goodbye/hoon
|=  *
|=  [planet=tape ~]
:_  ~  :_  ~
[%$ !&gt;(&quot;goodbye, {planet}.&quot;)]

~waclux-tomwyc/try=&gt; :cat /=try/(scot %da (sub -&lt;- ~m1))/bin/goodbye/hoon
|=  *
|=  [planet=tape ~]
:_  ~  :_  ~
[%$ !&gt;(&quot;hello, {planet}.&quot;)]
</code></pre></div>
<p>Ie, now it&#39;s goodbye and a minute ago it was hello.  This is
anything but fancy.  Finally, let&#39;s label it:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/try=&gt; :label %try %zebra
= new /~waclux-tomwyc/try/3

~waclux-tomwyc/try=&gt; :cat /=try/zebra/bin/goodbye/hoon
|=  *
|=  [planet=tape ~]
:_  ~  :_  ~
[%$ !&gt;(&quot;goodbye, {planet}.&quot;)]
</code></pre></div>
<p>Note that adding a label is part of the delta stream and creates
a new change number, <code>3</code>.</p>

<p>What&#39;s more, these revisions don&#39;t just apply in <code>:cat</code>.  Of
course, this is a program and it exists to be run.  Normally when
we say</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/try=&gt; :goodbye &quot;world&quot;
&quot;goodbye, world.&quot;
</code></pre></div>
<p>this actually does a path search and ends up as a shorthand for</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/try=&gt; :=/try=/bin/goodbye &quot;world&quot;
&quot;goodbye, world.&quot;
</code></pre></div>
<p>But of course, we can use the full revision notation here:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/try=&gt; :=/try/1/bin/goodbye &quot;world&quot;
&quot;hello, world.&quot;
~waclux-tomwyc/try=&gt; :=/try/2/bin/goodbye &quot;world&quot;
&quot;goodbye, world.&quot;
~waclux-tomwyc/try=&gt; :=/try/new/bin/goodbye &quot;world&quot;
&quot;goodbye, world.&quot;
</code></pre></div>
<p>Yeah, I guess that&#39;s kind of cool.  But... actually...</p>

<p>Arvo is anything but a fancy revision control system - partly
because it&#39;s a very young one, partly because it&#39;s cool to be
crude.  However, making revision control part of the OS, not on
top of the OS, opens up... certain... possibilities.</p>

<p>What happens if we try to use a revision that doesn&#39;t exist yet?
Remember that the <code>new</code> label was change <code>3</code>.  But suppose we try</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/try=&gt; :=/try/4/bin/goodbye &quot;world&quot;
[waiting...]
</code></pre></div>
<p>Hm?  Again, either quit with ^D, or use another window; edit 
<code>$URBIT_HOME/waclux-tomwyc/try/bin/goodbye.hoon</code>.  Change
&quot;goodbye&quot; to &quot;hasta la vista.&quot;  Then, <code>bin/vere mypier</code> if
you quit, or just hit space to trigger the sync.</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">vere: urbit home is /Users/cyarvin/Documents/src/u3/urb
loom: loaded 10MB
time: ~2013.9.2..07.26.20..b510
ames: on localhost, UDP 31337.
http: live on 8080
rest: checkpoint to event 965
rest: old 0v16.5un6m, new 0v1i.il78t

---------------- playback complete----------------
: /~waclux-tomwyc/try/4/bin/goodbye/hoon
&quot;hasta la vista, world.&quot;
</code></pre></div>
<p>Neighbor, tell me you&#39;ve seen <em>that</em> before.  Or with labels:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/try=&gt; :=/try/crazy/bin/goodbye &quot;world&quot;
[waiting...]
</code></pre></div>
<p>Use ^X to get a prompt back while this task waits.  Then, create
the label:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/try=&gt; :=/try/crazy/bin/goodbye &quot;world&quot;
~waclux-tomwyc/try=&gt; :label %try %crazy
= crazy /~waclux-tomwyc/try/5
&quot;hasta la vista, world.&quot;
</code></pre></div>
<p>What&#39;s going on here?  What&#39;s going on is that the Arvo
filesystem is an immutable, ie, referentially transparent,
namespace.  Since every path will only be bound to one file, when
we encounter a path that&#39;s not yet bound (but could be bound in
future), we do every OS&#39;s favorite thing - we <em>block</em>.</p>

<p>Civilization, a wise man once said, is the set of events you can
block on.  What&#39;s happening here is not in principle difficult at
all.  It is pretty hard to do, however, if your revision control
system is not in intimate proximity to your scheduler.</p>

<p>It would be difficult, we feel, to argue that this isn&#39;t cool.
But one could argue that it&#39;s just a party trick.  But once your
revision control system and your scheduler are jammed into one
phone booth... why not jam networking in there too?</p>

<h1>1.6 Network revision control</h1>

<p>Arvo is the OS.  Urbit is the network.  In theory you could write
an Urbit client that wasn&#39;t Arvo, though it&#39;s hard to see why.
But it seems unseemly to erase this distinction entirely.</p>

<p>So... let&#39;s do some networking.  Arvo is an immutable namespace.
But... Urbit is a <em>global</em> immutable namespace.</p>

<p>We sent you two destroyers, right?  You could run them both from
the same pier (ie, from the same Unix process), but this would be
confusing for a newb.  So it&#39;s time to make a new window and boot
up your second ship.  Let&#39;s say it&#39;s <code>~wolnum-sorleb</code>:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">vere -c otherpier
</code></pre></div>
<p>And follow the same directions as above.  If it worked, you
should be able to say hi to yourself:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~wolnum-sorleb/try=&gt; :hi ~waclux-tomwyc &quot;welcome to Urbit&quot;
; ~waclux-tomwyc is your neighbor
; ~waclux-tomwyc: &quot;this is fun&quot;

; ~wolnum-sorleb is your neighbor
~waclux-tomwyc/try=&gt; :hi ~wolnum-sorleb &quot;this is fun&quot;
; ~wolnum-sorleb: &quot;welcome to Urbit&quot;
</code></pre></div>
<p>(Neighbors are Urbit ships that have completed a symmetric key
exchange.  In most cases they will also be communicating via
direct UDP packets, though if both sides are behind bad NAT
gateways the (encrypted) packets have to bounce through our
servers.)</p>

<p>Okay, that seemed to work.  Now we can use the global namespace
as if <em>the whole world was one giant computer</em>:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/try=&gt; :cat /~wolnum-sorleb/try=/bin/goodbye/hoon
[waiting...]
|=  *
|=  [planet=tape ~]
:_  ~  :_  ~
[%$ !&gt;(&quot;hello, {planet}.&quot;)]

~waclux-tomwyc/try=&gt; :~wolnum-sorleb/try=/goodbye &quot;world&quot;
[waiting...]
&quot;hello, world.&quot;
</code></pre></div>
<p>Whoa.</p>

<p>But perhaps that was a little slow.  The network isn&#39;t very well
tuned yet, and there are several roundtrips as we request config
files that aren&#39;t actually there for this trivial app.  </p>

<p>Moreover, if we try it again, it&#39;ll be slow again, because we are
requesting files at the current date with that <code>try=</code>.  Let&#39;s try
to use a label instead:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/try=&gt; :~wolnum-sorleb/try/alpha/goodbye &quot;world&quot;
[waiting...]
</code></pre></div>
<p>Hey, whoops.  That label doesn&#39;t exist yet.  So, our process will
block forever until it does.  Let&#39;s go over to the other side and
create it:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~wolnum-sorleb/try=&gt; :label %try %alpha
= alpha /~wolnum-sorleb/try/2
</code></pre></div>
<p>At which point you&#39;ll see</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/try=&gt; :~wolnum-sorleb/try/alpha/goodbye &quot;world&quot;
&quot;hello, world.&quot;
</code></pre></div>
<p>Pretty cool, right?  Now try it again.  Since bindings are
permanent, it won&#39;t hit the network at all:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/try=&gt; :~wolnum-sorleb/try/alpha/goodbye &quot;world&quot;
&quot;hello, world.&quot;
</code></pre></div>
<p>Let&#39;s try it with some data:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclyx-tomwyc/try=&gt; (mul 10 ^:@/~wolnum-sorleb/try/beta/doc/fortytwo/noun)
[waiting...]

~wolnum-sorleb/try=&gt; :ram /===/doc/fortytwo/noun; (mul 6 7)
+ /~wolnum-sorleb/try/3/doc/fortytwo/noun
~wolnum-sorleb/try=&gt; :label %try %beta

~waclyx-tomwyc/try=&gt; (mul 10 ^:@/~wolnum-sorleb/try/beta/doc/fortytwo/noun)
420
</code></pre></div>
<p>So not only can you use any data in Urbit, on the command line
or in a program, as if it were a constant - if the data isn&#39;t 
available yet, your task will block until it is.</p>

<p>Of course, a cynic would say, this is just a party trick too.
True enough!  But perhaps it&#39;ll get the party&#39;s attention.</p>

<p>Obviously, what&#39;s going on here is that a file request is just a
special case of a subscribe operation.  An attempt to use a
resource, local or remote, that isn&#39;t ready, is automatically
treated as a subscription to that resource, and creates state on
the server that owns it which will be activated once the resource
does exist.  (And if you kill the requesting task on the client,
yes, it will cancel the request on the server.)</p>

<p>It&#39;s the combination of a purely functional language and OS with
a secure, referentially transparent global namespace that makes
Urbit a qualitatively different programming experience.  APIs are
great and REST is an attempt to make the Web almost functional,
but at bottom a Web request remains a side effect in a mutable
system.  While Urbit requests are built on a message queue layer
which you can use if you like, simply sharing data (and/or code)
isn&#39;t a matter of APIs, requests, installs, etc.  You just use it.</p>

<p>It is of course possible to build the same kinds of services with
20th-century Web protocols.  Just as there are revision control
servers on the Internet, there are pretty good (certainly much
more featureful) publish-and-subscribe protocols over HTTP.  But
such protocols are standalone systems, and difficult to integrate
with each other in a single programming environment and service
layer.</p>

<h1>1.7 Classic Unix crap#</h1>

<p>If a real OS runs on the bare hardware and is preemptive, it&#39;s
clear that Arvo is not a real OS and will never be one.  It will
always run on Unix.  Of course in a sense it comes to bury Unix,
but also to praise it - to imitate it - and even to surpass it.
Unix today is ancient, bloated and debilitated, but its historic
greatness is eternal.  Comparing Unix to other OSes of its time
is comparing Shakespeare to other playwrights of his time.</p>

<p>But, ya know, times change.  How do we surpass Unix?  We&#39;ve got
two words for you - typed pipes!  Yeah, Arvo has typed pipes.  It
also has typed arguments and even typed configurations.  These
types are probably not quite the types you&#39;re used to, if you&#39;re
a language geek (Hoon doesn&#39;t do PL theory), but they do the same
job and pretty well if we say so ourselves.</p>

<p>Broadly speaking, an Arvo task is a function that consumes events
and produces effects.  When you learn Hoon, we&#39;ll return to what
this actually means.  For now, this is a good excuse to see the 
classic server process that consumes events and produces effects -
a Web server.</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">~waclux-tomwyc/try=&gt; :game &quot;Elvis&quot;
[waiting...]
</code></pre></div>
<p>Point your browser at <code>localhost:$PORT/game/fun</code>, where $PORT is
the HTTP port shown when you started <code>vere</code>:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">http: live on 8080
</code></pre></div>
<p>Hit <code>^C</code> on the task when you&#39;re done.  Try editing the page
or the application:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">/=try=/bin/game/hoon
$URBIT_HOME/waclux-tomwyc/try/bin/game.hoon

/=try=/web/game/fun/hoon
$URBIT_HOME/waclux-tomwyc/try/web/game/fun.hoon
</code></pre></div>
<p>and then hitting reload.  You&#39;ll see that you need to restart the
server to change the app, but not to change the page.</p>

<p>Note that <code>fun.hoon</code> is not a template language - just Hoon.
Hoon is good at synthesizing hierarchical data structures
and does not need a DSL to generate XML, thank you very much.</p>

<p>Lorem ipsum...</p>

<h1>1.8 Update, upgrading and continuity</h1>

<p>To update the </p>

</div>



    </div>

  </body>
</html>
